- incremental_backup.lifecycle:
    type = incremental_backup_lifecycle
    start_vm = "no"
    disk_type = "file"
    target_disk = "vda"
    disk_dict = {"type_name": ${disk_type}, "target":{"dev": "%s", "bus": "virtio"}, "driver": {"name": "qemu", "type": "qcow2"}}
    full_checkpoint = "check_full"
    inc_checkpoint = "check_inc1"
    nbd_hostname = "localhost"
    nbd_tcp_port = "10809"
    backup_dict = {'mode': 'pull', 'server': {'name': '${nbd_hostname}', 'port': '${nbd_tcp_port}'}, 'disks': [{'name': 'vda', 'backup': 'yes', 'type': 'file', 'scratch': {'attrs': {'file': '%s'}}}]}
    checkpoint_dict = {'name': '%s', 'disks': [{'name': 'vda', 'checkpoint': 'bitmap'}]}
    inc_backup_dict = {'mode': 'pull', 'incremental': '${full_checkpoint}', 'server': {'name': '${nbd_hostname}', 'port': '${nbd_tcp_port}'}, 'disks': [{'name': 'vda', 'backup': 'yes', 'type': 'file', 'scratch': {'attrs': {'file': '%s'}}}]}
    variants test_case:
        - save_vm:
            expected_error = "Timed out during operation: cannot acquire state change lock.*remoteDispatchDomainBackupBegin"
        - managedsave:
            expected_error = "Timed out during operation: cannot acquire state change lock.*remoteDispatchDomainBackupBegin"
        - restart_service:
            expected_error = "Timed out during operation: cannot acquire state change lock.*monitor"
        - kill_qemu_during_libvirtd_restart:
            expected_error = ""
        - shutdown_vm:
            func_supported_since_libvirt_ver = (11, 10, 0)
            backup_dict = {'mode': 'push', 'disks': [{'name': 'vda', 'backup': 'yes', 'type': 'file', 'target': {'attrs': {'file': '%s'}}, 'driver': {'type': 'qcow2'}}]}
            backup_options_extra = " --preserve-domain-on-shutdown"
            expected_error = ""
            variants:
                - with_resume:
                    resume_after_shutdown = "yes"
                - without_resume:
