- virtual_network.migrate.migrate_with_ethernet_interface:
    type = migrate_with_ethernet_interface
    start_vm = "no"
    take_regular_screendumps = no
    storage_type = 'nfs'
    setup_local_nfs = 'yes'
    disk_type = "file"
    disk_source_protocol = "netfs"
    nfs_mount_dir = "/var/lib/libvirt/migrate"
    nfs_mount_options = "soft,timeo=50,retrans=3"
    virsh_migrate_dest_state = running
    virsh_migrate_options = "--live --p2p --verbose"
    outside_ip = "www.google.com"
    migration_setup = "yes"
    iface_model = "virtio"
    ssh_remote_auth = True
    unprivileged_user = "${test_user}"
    mnt_path_name = ${nfs_mount_dir}
    nfs_server_ip = "${migrate_source_host}"
    migrate_desturi_port = "22"
    migrate_desturi_type = "ssh"
    virsh_migrate_desturi = "qemu+ssh://%s@${migrate_dest_host}/session"
    vm_ping_outside = "pass"
    check_network_accessibility_after_mig = "yes"

    # Ethernet interface specific settings
    bridge_name = "br0"
    tap_name = "mytap0"
    tap_mtu = "9000"
    # Ethernet interface configuration with managed=no
    iface_attrs = {'type_name': 'ethernet', 'target': {'dev': '${tap_name}', 'managed': 'no'}, 'model': '${iface_model}', 'mtu': {'size': '9000'}}
    variants:
        - precopy_migration:
            migration_type = "precopy"
            virsh_migrate_extra = ""
            migrate_vm_back = "yes"
        - postcopy_migration:
            migration_type = "postcopy"
            virsh_migrate_extra = "--postcopy --timeout 10 --timeout-postcopy --bandwidth 1"
            migrate_vm_back = "yes"
        - cancel_migration:
            migration_type = "cancel"
            cancel_migration = "yes"
            status_error = "yes"
            err_msg = "operation aborted: migration out job: canceled by client|operation aborted: job 'migration out' canceled by client"
            virsh_migrate_extra = "--bandwidth 10"
            action_during_mig = '[{"func": "virsh.domjobabort", "after_event": "iteration: '1'", "func_param": "'%s' % params.get('migrate_main_vm')"}]'

    variants:
        - unprivileged_user:

