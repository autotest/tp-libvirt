- virtual_network.attach_detach_device.attach_detach_nat_interface:
    type = attach_detach_nat_interface
    start_vm = no
    take_regular_screendumps = no
    login_timeout = 240
    ping_target = "www.google.com"
    iface_type = "network"
    test_mac = "52:54:00:b7:0e:66"
    test_mtu = "3000"
    test_target_dev = "test"
    link_up = "up"
    test_alias = "ua-2c8c5183-096a-48aa-b36d-58f49b62acd4"
    acpi_idx = "6"
    coalesce_max = "7"
    tune_sndbuf = 1600
    check_dev = "${test_target_dev}"
    bridge_name = "virbr1"
    variants:
        - matrix1_qos_mac_mtu_target_link_alias:
            matrix_name = "matrix_1"
            basic_config = {'type_name': 'network', 'source': {'network': 'default'}, 'mac_address': '${test_mac}', 'model': 'virtio', 'mtu': {'size': '${test_mtu}'}, "link_state": "${link_up}", 'target': {'dev': '${test_target_dev}'}}
            bandwidth_alias = {'bandwidth': {'inbound': {'average': '100', 'peak': '400', 'burst': '256'}, 'outbound': {'average': '200', 'peak': '300', 'burst': '256'}}, 'alias': {'name': '${test_alias}'}}
            iface_dict = {**${basic_config}, **${bandwidth_alias}}
            expected_checks = {'qos': True, 'mac': '${test_mac}', 'mtu': ${test_mtu}, 'target_dev': '${test_target_dev}', 'link_state': '${link_up}', 'alias': '${test_alias}'}
            expected_xpaths = [{'element_attrs': ["//interface[@type='network']", "//interface/source[@network='default']", "//interface/mac[@address='${test_mac}']", "//interface/model[@type='virtio']", "//interface/mtu[@size='${test_mtu}']", "//interface/link[@state='${link_up}']", "//interface/target[@dev='${test_target_dev}']", "//interface/alias[@name='${test_alias}']", "//interface/bandwidth/inbound[@average='100'][@peak='400'][@burst='256']", "//interface/bandwidth/outbound[@average='200'][@peak='300'][@burst='256']"]}]

        - matrix2_acpi_tune_coalesce_backend_rom:
            matrix_name = "matrix_2"
            basic_config = {'type_name': 'network', 'source': {'network': 'default'}, 'model': 'virtio', 'target': {'dev': '${test_target_dev}'}}
            advanced_config = {'backend': {'tap': '/dev/net/tun', 'vhost': '/dev/vhost-net'}, 'tune': {'sndbuf': ${tune_sndbuf}}, 'coalesce': {'max': '7'}, 'acpi': {'index': '${acpi_idx}'}, 'rom': {'bar': 'on', 'file': '/usr/share/ipxe/1af41000.rom', 'enabled': 'yes'}}
            iface_dict = {**${basic_config}, **${advanced_config}}
            expected_checks = {'acpi_index': ${acpi_idx}, 'coalesce': ${coalesce_max}, 'backend': 'tap', 'rom': True, 'target_dev': '${test_target_dev}'}
            expected_xpaths = [{'element_attrs': ["//interface[@type='network']", "//interface/source[@network='default']", "//interface/model[@type='virtio']", "//interface/target[@dev='${test_target_dev}']", "//interface/backend[@tap='/dev/net/tun'][@vhost='/dev/vhost-net']", "//interface/coalesce/rx/frames[@max='${coalesce_max}']", "//interface/acpi[@index='${acpi_idx}']", "//interface/rom[@bar='on'][@file='/usr/share/ipxe/1af41000.rom'][@enabled='yes']"]}, {'element_attrs':["//interface/tune/sndbuf"], 'text':'${tune_sndbuf}'}]

        - matrix3_driver_elements_4vcpus:
            matrix_name = "matrix_3"
            vm_attrs = {"vcpu": 4}
            driver_queues = "4"
            rx_queue_size = '1024'
            tx_queue_size = '256'
            basic_config = {'type_name': 'network', 'source': {'network': 'default'}, 'model': 'virtio', 'target': {'dev': '${test_target_dev}'}}
            driver_config = {'driver':{'driver_attr':{'name': 'vhost', 'txmode': 'iothread', 'ioeventfd': 'on', 'event_idx': 'off', 'queues': '${driver_queues}', 'rss': 'on', 'rss_hash_report': 'on', 'page_per_vq': 'on', 'rx_queue_size': '${rx_queue_size}', 'tx_queue_size': '${tx_queue_size}'},'driver_host': {'csum': 'off', 'gso': 'off', 'tso4': 'off', 'tso6': 'off', 'ecn': 'off', 'ufo': 'off', 'mrg_rxbuf': 'off'}, 'driver_guest': {'csum': 'off', 'tso4': 'off', 'tso6': 'off', 'ecn': 'off', 'ufo': 'off'}}}
            iface_dict = {**${basic_config}, **${driver_config}}
            expected_checks = {'target_dev': '${test_target_dev}', 'offloads': {'tx-tcp6-segmentation': False, 'tcp-segmentation-offload': False, 'tx-tcp-segmentation': False, 'tx-tcp-ecn-segmentation': False, 'tx-checksumming': False}, 'page_per_vq':'on', 'queue_size': {'rx_queue_size': '${rx_queue_size}', 'tx_queue_size': '${tx_queue_size}'}}
            expected_xpaths = [{'element_attrs': ["//interface[@type='network']", "//interface/source[@network='default']", "//interface/model[@type='virtio']", "//interface/target[@dev='${test_target_dev}']", "//interface/driver[@name='vhost'][@txmode='iothread'][@ioeventfd='on'][@event_idx='off'][@queues='${driver_queues}'][@rss='on'][@rss_hash_report='on'][@page_per_vq='on'][@rx_queue_size='${rx_queue_size}'][@tx_queue_size='${tx_queue_size}']", "//interface/driver/host[@csum='off'][@gso='off'][@tso4='off'][@tso6='off'][@ecn='off'][@ufo='off'][@mrg_rxbuf='off']", "//interface/driver/guest[@csum='off'][@tso4='off'][@tso6='off'][@ecn='off'][@ufo='off']"]}]
