- graphics.spice:
    type = spice
    start_vm = no
    spice_tls = 1
    variants:
        - positive_tests:
            variants:
                - default:
                - port_-1:
                    port = -1
                - port_0:
                    port = 0
                - port_65535:
                    port = 65535
                - tlsport_-1:
                    tlsPort = -1
                - tlsport_0:
                    tlsPort = 0
                - tlsport_65535:
                    tlsPort = 65535
                - only_secure_channels:
                    # https://bugzilla.redhat.com/show_bug.cgi?id=1143832
                    channels = main:secure,inputs:secure,display:secure,cursor:secure,playback:secure,record:secure,smartcard:secure,usbredir:secure
                - only_insecure_channels:
                    # https://bugzilla.redhat.com/show_bug.cgi?id=1143832
                    channels = main:insecure,inputs:insecure,display:insecure,cursor:insecure,playback:insecure,record:insecure,smartcard:insecure,usbredir:insecure
                - mixed_channels:
                    channels = main:secure,inputs:insecure,display:secure,cursor:insecure,playback:secure,record:insecure,smartcard:secure,usbredir:insecure
                - spice_listen_all_ipv4:
                    spice_listen = '0.0.0.0'
                - spice_listen_all_ipv6:
                    spice_listen = '::'
                - spice_listen_ipv4:
                    spice_listen = 'valid_ipv4'
                - spice_listen_ipv6:
                    spice_listen = 'valid_ipv6'
                - listen_address_override_spice_listen:
                    spice_listen = '0.0.0.0'
                    listen_type = 'address'
                    listen_address = '127.0.0.1'
                - listen_address_all_ipv4:
                    listen_type = 'address'
                    listen_address = '0.0.0.0'
                - listen_address_all_ipv6:
                    listen_type = 'address'
                    listen_address = '::'
                - listen_address_ipv4:
                    listen_type = 'address'
                    listen_address = 'valid_ipv4'
                - listen_address_ipv6:
                    listen_type = 'address'
                    listen_address = 'valid_ipv6'
                - listen_vnet:
                    listen_type = 'network'
                    network_type = 'vnet'
                    vnet_address = '192.168.123.1'
                - listen_macvtap:
                    listen_type = 'network'
                    network_type = 'macvtap'
                    macvtap_device = 'EXAMPLE.NETWORK.INTERFACE'
                - listen_bridge:
                    listen_type = 'network'
                    network_type = 'bridge'
                    bridge_device = 'EXAMPLE.BRIDGE.INTERFACE'
                - defaultMode_secure:
                    defaultMode = secure
                - defaultMode_secure_port_-1:
                    autoport = no
                    defaultMode = secure
                    port = -1
                - defaultMode_insecure_tlsPort_-1:
                    autoport = no
                    defaultMode = insecure
                    tlsPort = -1
                - defaultMode_insecure:
                    defaultMode = insecure
                - defaultMode_any:
                    defaultMode = any
                - image_compression_auto_glz:
                    image_compression = auto_glz
                - image_compression_auto_lz:
                    image_compression = auto_lz
                - image_compression_quic:
                    image_compression = quic
                - image_compression_glz:
                    image_compression = glz
                - image_compression_lz:
                    image_compression = lz
                - image_compression_off:
                    image_compression = off
                - jpeg_compression_auto:
                    jpeg_compression = auto
                - jpeg_compression_never:
                    jpeg_compression = never
                - jpeg_compression_always:
                    jpeg_compression = always
                - zlib_compression_auto:
                    zlib_compression = auto
                - zlib_compression_never:
                    zlib_compression = never
                - zlib_compression_always:
                    zlib_compression = always
                - playback_compression_on:
                    playback_compression = on
                - playback_compression_off:
                    playback_compression = off
        - negative_tests:
            variants:
                - autoport_no:
                    autoport = no
                    variants:
                        - spice_tls_disabled_ports_not_set:
                            spice_tls = 0
                        - spice_tls_disabled_tlsport_set:
                            tlsPort = 65535
                            spice_tls = 0
                        - default_secure_mode_ports_not_set:
                            defaultMode = secure
                        - default_insecure_mode_ports_not_set:
                            defaultMode = insecure
                        - with_secure_channel_ports_not_set:
                            channels = main:secure,inputs:secure,display:secure,cursor:secure,playback:secure,record:secure,smartcard:secure,usbredir:secure
                        - with_insecure_channel_ports_not_set:
                            channels = main:insecure,inputs:insecure,display:insecure,cursor:insecure,playback:insecure,record:insecure,smartcard:insecure,usbredir:insecure
                        - with_both_channel_ports_not_set:
                            channels = main:secure,inputs:insecure,display:secure,cursor:insecure,playback:secure,record:insecure,smartcard:secure,usbredir:insecure
                        - equal_ports_1:
                            port = 1
                            tlsPort = 1
                        - equal_ports_-2:
                            port = -2
                            tlsPort = -2
                        - equal_ports_65536:
                            port = 65536
                            tlsPort = 65536
                        - equal_ports_65535:
                            port = 65535
                            tlsPort = 65535
                        - without_cert:
                            tlsPort = 65535
                            prepare_cert = no
                        - ports_not_set:
                        - port_-2:
                            port = -2
                        - port_1:
                            port = 1
                        - port_65536:
                            port = 65536
                        - tlsport_-2:
                            tlsPort = -2
                        - tlsport_1:
                            tlsPort = 1
                        - tlsport_65536:
                            tlsPort = 65536
                - spice_listen_non_exist:
                    spice_listen = '123.123.123.123'
                - no_port_avail:
                    remote_display_port_min = 5910
                    remote_display_port_max = 5911
                    block_port = 5910,5911
