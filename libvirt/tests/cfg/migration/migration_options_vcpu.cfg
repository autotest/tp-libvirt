- virsh.migration_options_vcpu:
    type = migration_options_vcpu
    # Migrating non-started VM causes undefined behavior
    start_vm = yes
    # Console output can only be monitored via virsh console output
    only_pty = True
    take_regular_screendumps = no
    # Options to pass to virsh migrate command before <domain> <desturi>
    virsh_migrate_options = "--live --verbose"
    # Extra options to pass after <domain> <desturi>
    virsh_migrate_extra = ""
    # SSH connection time out
    ssh_timeout = 60
    # Remember to open ports 49152-49216 on destination and
    # NAT-based host networking will cause external connectivity-loss
    # to guest, consider a shared-bridge setup instead.
    # FIXME: Implement libvirt URI connect user/password
    # virsh_migrate_destuser = root
    # virsh_migrate_destpwd = ""
    migration_setup = "yes"
    storage_type = 'nfs'
    setup_local_nfs = 'yes'
    virsh_migrate_dest_state = running
    virsh_migrate_src_state = running
    virsh_migrate_libvirtd_state = 'on'
    # Local URI
    virsh_migrate_connect_uri = "qemu:///system"
    log_outputs = "/var/log/libvirt/libvirtd.log"
    
    # Migration mode - only precopy/without_postcopy for vcpu tests
    postcopy_options = ""
    
    # Migrate VM back to verify bidirectional migration
    migrate_vm_back = "yes"
    
    # Check guest XML after migration to verify vcpu count
    guest_xml_check_after_mig = "<vcpu placement='static'>"
    
    variants:
        - vcpu_1:
            vcpu_num = 1
        - vcpu_4:
            vcpu_num = 4
        - vcpu_8:
            vcpu_num = 8
        - vcpu_16:
            vcpu_num = 16

